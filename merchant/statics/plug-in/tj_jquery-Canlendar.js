(function(B){if(B.Calendar){return}B.Calendar=function(A,D){this.$el=B(D);this._init(A)};B.Calendar.defaults={"reg_year":1900,"reg_month":1,"reg_date":1,"target":null,"cate":"","column_style":"default","callback":null,"date_range_begin":{"year":0,"month":0,"day":0},"date_range_end":{"year":0,"month":0,"day":0},"ifrange_same":null,"begin_today":false,"year_range":2};B.Calendar.prototype={_init:function(t){var y={"data_begin":{"data-full":"","data-year":"","data-month":"","data-day":""},"data_end":{"data-full":"","data-year":"","data-month":"","data-day":""}};t=B.extend(true,{},B.Calendar.defaults,t);this.repeat=false;this.differ=false;this.changeOption=function(D,E,C){Aj=D;l=E;m=C;y["data_end"]["data-full"]="";y["data_end"]["data-year"]="";y["data_end"]["data-month"]="";y["data_end"]["data-day"]="";y["data_begin"]["data-full"]="";y["data_begin"]["data-year"]="";y["data_begin"]["data-month"]="";y["data_begin"]["data-day"]="";Al();j();Ab()};this.rerange=function(C,D){y["data_begin"]["data-full"]=C.year+"/"+C.month+"/"+C.day;y["data_begin"]["data-year"]=C.year;y["data_begin"]["data-month"]=C.month;y["data_begin"]["data-day"]=C.day;y["data_end"]["data-full"]=D.year+"/"+C.month+"/"+C.day;y["data_end"]["data-year"]=D.year;y["data_end"]["data-month"]=D.month;y["data_end"]["data-day"]=D.day;q();Ab();j()};if(t["ifrange_same"]!==null){var x=t["date_range_begin"];var Ai=t["date_range_end"];if(t["ifrange_same"]){y["data_begin"]["data-full"]=x.year+"/"+x.month+"/"+x.day;y["data_begin"]["data-year"]=x.year;y["data_begin"]["data-month"]=x.month;y["data_begin"]["data-day"]=x.day}else{y["data_begin"]["data-full"]=x.year+"/"+x.month+"/"+x.day;y["data_begin"]["data-year"]=x.year;y["data_begin"]["data-month"]=x.month;y["data_begin"]["data-day"]=x.day;y["data_end"]["data-full"]=Ai.year+"/"+Ai.month+"/"+Ai.day;y["data_end"]["data-year"]=Ai.year;y["data_end"]["data-month"]=Ai.month;y["data_end"]["data-day"]=Ai.day}}var Ak=this.$el;var r=t["target"];var p=t["column_style"];if(p=="onecolumn"){Ak.addClass("onecolumn");Ak.find(".ds-table1 .calendarWrap2").show()}var A=t["cate"];var Aj=t["reg_year"];var l=t["reg_month"];var m=t["reg_date"];var v=typeof(now_date)=="undefined"?new Date():now_date;var Ad=v.getMonth();var z=v.getFullYear();var Af=v.getDate();var n=Af;var Ae=Ad;var o=z;if(t.begin_today){Aj=z;l=Ad+1;m=Af}var Ah=t["callback"];var u,s,Ac,i,w,h;var Ag=function(){if(Ad==1){u=12;s=1;Ac=2;i=z-1;w=z;h=z}else{if(Ad==0){u=11;s=12;Ac=1;i=z-1;w=z-1;h=z}else{u=Ad-1;s=Ad;Ac=Ad+1;i=z;w=z;h=z}}};var Aa=function(D,C){if(C==1||C==3||C==5||C==7||C==8||C==10||C==12){return 31}else{if(C==4||C==6||C==9||C==11){return 30}else{if(C==2&&D%4==0){return 29}else{return 28}}}};var k=function(H,I){var Z="";var R="";var M="";var a="";if(t.begin_today){for(var N=o;N<=o+1;N++){R+='<a  href="#" class="time_select_btn" date-time="'+N+'">'+N+"</a>"}}else{for(var N=(o-t.year_range-1);N<=o;N++){R+='<a  href="#" class="time_select_btn" date-time="'+N+'">'+N+"</a>"}}var T='<div date-year="'+H+'" class="select_year">                                <div class="s_year_bg"></div>                                <div class="s_year_bx">                                    <span class="ca_arrow"></span>                                    <div class="s_hd">'+H+' 年</div>                                </div>                                <div class="po_select_list clearfix">'+R+"</div></div>";for(var N=1;N<=12;N++){M+='<a  href="#" class="time_select_btn" date-time="'+N+'">'+N+"</a>"}var W='<div date-month="'+I+'" class="select_month">                                <div class="s_month_bg"></div>                                <div class="s_month_bx">                                    <span class="ca_arrow"></span>                                    <div class="s_hd">'+I+' 月</div>                                </div>                                <div class="po_select_list clearfix">'+M+"</div></div>";var L='<div m="'+I+'" y="'+H+'"  class="ds-cal-head cal_select_bar fix" >'+T+W+"</div>";var J="";var F=H+"/"+I+"/1";var U=new Date(Date.parse(F));var Q=U.getDay();var P=Aa(H,I);var N=0;var G=Q;var V="";var X=1;var K,C;if(I==1){K=H-1;C=12}else{K=H;C=I-1}var S=Aa(K,C);while(N<P){var Y="";for(var D=0;D<7;D++){if(N<G){var O=S-G+1;Y+='<td class="last_date">'+O+"</td>";G--}else{if(N==P){Y+='<td class="last_date">'+X+"</td>";X++;G--}else{var U=N+1;var E;if(t.begin_today){E=((I==l&&H==Aj&&U<m)||(I<l&&H==Aj)||H<Aj)}else{E=(((I-1)==Ae&&H==o&&U>n)||(I==l&&H==Aj&&U<m)||(I<l&&H==Aj)||H<Aj||H>o||((I-1)>Ae&&H==o))}if(E){Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth date-grey">'+U+"</td>"}else{if((I-1)==Ae&&H==o&&U==n){if((I==y["data_begin"]["data-month"]&&U==y["data_begin"]["data-day"]&&H==y["data_begin"]["data-year"])||(I==y["data_end"]["data-month"]&&U<=y["data_end"]["data-day"]&&H==y["data_end"]["data-year"])||(I<y["data_end"]["data-month"]&&H==y["data_end"]["data-year"])||(H<y["data_end"]["data-year"])){Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth curday ds-date-selected">'+U+"</td>"}else{if(t["ifrange_same"]===null){Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth curday date-now">'+U+"</td>"}else{Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth">'+U+"</td>"}}}else{if(y["data_begin"]["data-full"]&&!y["data_end"]["data-full"]&&H==y["data_begin"]["data-year"]&&I==y["data_begin"]["data-month"]&&U==y["data_begin"]["data-day"]){Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth ds-date-selected">'+U+"</td>"}else{if(y["data_begin"]["data-full"]&&y["data_end"]["data-full"]&&((y["data_begin"]["data-year"]==y["data_end"]["data-year"]&&y["data_begin"]["data-month"]==y["data_end"]["data-month"]&&H==y["data_begin"]["data-year"]&&I==y["data_begin"]["data-month"]&&y["data_end"]["data-day"]>=U&&U>=y["data_begin"]["data-day"])||(y["data_begin"]["data-year"]==y["data_end"]["data-year"]&&y["data_begin"]["data-month"]<y["data_end"]["data-month"]&&H==y["data_begin"]["data-year"]&&((I==y["data_begin"]["data-month"]&&y["data_begin"]["data-day"]<=U)||(I>y["data_begin"]["data-month"]&&I<y["data_end"]["data-month"])||(I==y["data_end"]["data-month"]&&y["data_end"]["data-day"]>=U)))||(y["data_begin"]["data-year"]<y["data_end"]["data-year"]&&((H==y["data_begin"]["data-year"]&&((I==y["data_begin"]["data-month"]&&y["data_begin"]["data-day"]<=U)||(I>y["data_begin"]["data-month"])))||(H>y["data_begin"]["data-year"]&&H<y["data_end"]["data-year"])||(H==y["data_end"]["data-year"]&&((I==y["data_end"]["data-month"]&&y["data_end"]["data-day"]>=U)||(I<y["data_end"]["data-month"]))))))){Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth ds-date-selected">'+U+"</td>"}else{Y+='<td data-year="'+H+'" data-month="'+I+'" data-day="'+U+'" data-full="'+H+"/"+I+"/"+U+'"  style=""  class="ds-date-thismonth">'+U+"</td>"}}}}N++}}}lineStru="<tr>"+Y+"</tr>";V+=lineStru}J='<table cellspacing="0" cellpadding="0" border="0" class=""><tr class="thead"><td class="date-t-hg">日</td><td>一</td><td>二</td><td>三</td><td>四</td><td>五</td><td class="date-t-hg">六</td></tr>'+V+"</table>";Z=L+J;return Z};Ak.find(".lasttomorrow_key").click(function(F){F.preventDefault();var E=new Date();E.setDate(E.getDate()-2);var G=E.getFullYear();var D=E.getMonth()+1;var C=E.getDate();y["data_begin"]["data-full"]=G+"/"+D+"/"+C;y["data_begin"]["data-year"]=G;y["data_begin"]["data-month"]=D;y["data_begin"]["data-day"]=C;y["data_end"]["data-full"]="";y["data_end"]["data-year"]="";y["data_end"]["data-month"]="";y["data_end"]["data-day"]="";q();Ab();j();Ak.find(".yes_btn").trigger("click")});Ak.find(".tomorrow_key").click(function(F){F.preventDefault();var E=new Date();E.setDate(E.getDate()-1);var G=E.getFullYear();var D=E.getMonth()+1;var C=E.getDate();y["data_begin"]["data-full"]=G+"/"+D+"/"+C;y["data_begin"]["data-year"]=G;y["data_begin"]["data-month"]=D;y["data_begin"]["data-day"]=C;y["data_end"]["data-full"]="";y["data_end"]["data-year"]="";y["data_end"]["data-month"]="";y["data_end"]["data-day"]="";q();Ab();j();Ak.find(".yes_btn").trigger("click")});Ak.find(".today_key").click(function(D){D.preventDefault();var C=Ad+1;y["data_begin"]["data-full"]=z+"/"+C+"/"+Af;y["data_begin"]["data-year"]=z;y["data_begin"]["data-month"]=C;y["data_begin"]["data-day"]=Af;y["data_end"]["data-full"]="";y["data_end"]["data-year"]="";y["data_end"]["data-month"]="";y["data_end"]["data-day"]="";q();Ab();j();Ak.find(".yes_btn").trigger("click")});Ak.find(".weekly_key").click(function(M){M.preventDefault();var L=Ad+1;var I=z+"/"+L+"/"+Af;oToday=new Date(I);currentDay=oToday.getDay();if(currentDay==0){currentDay=7}mondayTime=oToday.getTime()-(currentDay-1)*24*60*60*1000;sundayTime=oToday.getTime()+(7-currentDay)*24*60*60*1000;var H=new Date(mondayTime);var J=H.getFullYear();var K=H.getMonth()+1;var F=H.getDate();var C=new Date(sundayTime);var G=C.getFullYear();var D=C.getMonth()+1;var E=C.getDate();y["data_begin"]["data-full"]=J+"/"+K+"/"+F;y["data_begin"]["data-year"]=J;y["data_begin"]["data-month"]=K;y["data_begin"]["data-day"]=F;y["data_end"]["data-full"]=G+"/"+D+"/"+E;y["data_end"]["data-year"]=G;y["data_end"]["data-month"]=D;y["data_end"]["data-day"]=E;q();Ab();j();Ak.find(".yes_btn").trigger("click")});Ak.find(".monthly_key").click(function(E){E.preventDefault();var D=Ad+1;var C=Aa(z,D);y["data_begin"]["data-full"]=z+"/"+D+"/1";y["data_begin"]["data-year"]=z;y["data_begin"]["data-month"]=D;y["data_begin"]["data-day"]=1;y["data_end"]["data-full"]=z+"/"+D+"/"+C;y["data_end"]["data-year"]=z;y["data_end"]["data-month"]=D;y["data_end"]["data-day"]=C;q();Ab();j();Ak.find(".yes_btn").trigger("click")});var Ab=function(){Ak.find(".s_year_bx").each(function(){var E=B(this).data("clickbind");var F=B(this).parents(".ds-table2");var D=B(this).next();var C=B(this).parent();if(!E){B(this).click(function(G){G.stopPropagation();if(D.is(":visible")){D.hide();C.removeClass("se_year_down")}else{B(".po_select_list").hide();B(".se_year_down").removeClass("se_year_down");B(".se_month_down").removeClass("se_month_down");D.show();C.addClass("se_year_down")}if(F.size()){F.addClass("ds-table2-high")}else{B(".ds-table2").removeClass("ds-table2-high")}});B(this).data("clickbind","clickbind")}});Ak.find(".select_year .time_select_btn").each(function(D){var C=B(this).data("clickbind");if(!C){B(this).click(function(E){E.stopPropagation();E.preventDefault();var F=parseInt(B(this).parents(".select_year").next().attr("date-month"));var G=parseInt(B(this).attr("date-time"));if(B(this).parents(".calendarWrap1").size()){w=G;s=F}else{h=G;Ac=F}q();Ab();j()});B(this).data("clickbind","clickbind")}});Ak.find(".s_month_bx").each(function(){var E=B(this).data("clickbind");var F=B(this).parents(".ds-table2");var D=B(this).next();var C=B(this).parent();if(!E){B(this).click(function(G){G.stopPropagation();if(D.is(":visible")){D.hide();C.removeClass("se_month_down")}else{B(".po_select_list").hide();B(".se_year_down").removeClass("se_year_down");B(".se_monthr_down").removeClass("se_month_down");D.show();C.addClass("se_month_down")}if(F.size()){F.addClass("ds-table2-high")}else{B(".ds-table2").removeClass("ds-table2-high")}})}});Ak.find(".select_month .time_select_btn").each(function(D){var C=B(this).data("clickbind");if(!C){B(this).click(function(E){E.stopPropagation();E.preventDefault();var G=parseInt(B(this).parents(".select_month").prev().attr("date-year"));var F=parseInt(B(this).attr("date-time"));if(B(this).parents(".calendarWrap1").size()){w=G;s=F}else{h=G;Ac=F}q();Ab();j()});B(this).data("clickbind","clickbind")}})};var q=function(){var C=k(w,s);var D=k(h,Ac);if(A=="onecolumn"){Ak.find(".calendarWrap2").html(D)}else{Ak.find(".calendarWrap1").html(C);Ak.find(".calendarWrap2").html(D)}};Ak.find(".yes_btn").click(function(C){C.stopPropagation();if(!y["data_begin"]["data-full"]){alert("请选择时间")}if(y["data_begin"]["data-full"]&&!y["data_end"]["data-full"]){r.val(y["data_begin"]["data-full"]);r.attr("data-begin",y["data_begin"]["data-full"]);r.attr("data-end",y["data_begin"]["data-full"]);if(typeof Ah=="function"){Ah(y["data_begin"]["data-full"],y["data_end"]["data-full"])}Ak.parents(".fc_screening_area").removeClass("fc_screening_area_cur");Ak.parents(".fc_screening_area").find(".fc_area_sub").hide();if(!Ak.parents(".fc_area_sub").size()){Ak.hide()}}else{if(y["data_begin"]["data-full"]&&y["data_end"]["data-full"]){r.val(y["data_begin"]["data-full"]+" 至 "+y["data_end"]["data-full"]);r.attr("data-begin",y["data_begin"]["data-full"]);r.attr("data-end",y["data_end"]["data-full"]);if(typeof Ah=="function"){Ah(y["data_begin"]["data-full"],y["data_end"]["data-full"])}Ak.parents(".fc_screening_area").removeClass("fc_screening_area_cur");Ak.parents(".fc_screening_area").find(".fc_area_sub").hide();if(!Ak.parents(".fc_area_sub").size()){Ak.hide()}}}});Ak.find(".cancel_btn").click(function(){Ak.parents(".fc_screening_area").removeClass("fc_screening_area_cur");Ak.parents(".fc_screening_area").find(".fc_area_sub").hide()});var j=function(){Ak.find("td.ds-date-thismonth").click(function(E){E.stopPropagation();if(B(this).hasClass("date-grey")){}else{if(p=="onecolumn"){y["data_begin"]["data-full"]=B(this).attr("data-full");y["data_begin"]["data-year"]=B(this).attr("data-year");y["data_begin"]["data-month"]=B(this).attr("data-month");y["data_begin"]["data-day"]=B(this).attr("data-day");Ak.find(".yes_btn").trigger("click")}else{if(!y["data_begin"]["data-full"]){y["data_begin"]["data-full"]=B(this).attr("data-full");y["data_begin"]["data-year"]=B(this).attr("data-year");y["data_begin"]["data-month"]=B(this).attr("data-month");y["data_begin"]["data-day"]=B(this).attr("data-day")}else{if(y["data_begin"]["data-full"]&&y["data_end"]["data-full"]){y["data_begin"]["data-full"]=B(this).attr("data-full");y["data_begin"]["data-year"]=B(this).attr("data-year");y["data_begin"]["data-month"]=B(this).attr("data-month");y["data_begin"]["data-day"]=B(this).attr("data-day");y["data_end"]["data-full"]="";y["data_end"]["data-year"]="";y["data_end"]["data-month"]="";y["data_end"]["data-day"]=""}else{if(y["data_begin"]["data-full"]){var J=y["data_begin"];var G=B(this).attr("data-year");var I=B(this).attr("data-month");var H=B(this).attr("data-day");var K=Ak.find('td[data-full="'+J+'"]');var F=y["data_begin"]["data-year"];var D=y["data_begin"]["data-month"];var C=y["data_begin"]["data-day"];if(B(this).attr("data-full")!=y["data_begin"]["data-full"]){this.repeat=false;this.differ=true;if(parseInt(G)==parseInt(F)&&parseInt(I)==parseInt(D)){if(parseInt(H)<parseInt(C)){y["data_end"]["data-full"]=y["data_begin"]["data-full"];y["data_end"]["data-year"]=y["data_begin"]["data-year"];y["data_end"]["data-month"]=y["data_begin"]["data-month"];y["data_end"]["data-day"]=y["data_begin"]["data-day"];y["data_begin"]["data-full"]=B(this).attr("data-full");y["data_begin"]["data-year"]=parseInt(B(this).attr("data-year"));y["data_begin"]["data-month"]=parseInt(B(this).attr("data-month"));y["data_begin"]["data-day"]=parseInt(B(this).attr("data-day"))}else{if(parseInt(H)>parseInt(C)){y["data_end"]["data-full"]=B(this).attr("data-full");y["data_end"]["data-year"]=parseInt(B(this).attr("data-year"));y["data_end"]["data-month"]=parseInt(B(this).attr("data-month"));y["data_end"]["data-day"]=parseInt(B(this).attr("data-day"))}}}else{if(parseInt(G)==parseInt(F)&&parseInt(I)!=parseInt(D)){if(parseInt(I)>parseInt(D)){y["data_end"]["data-full"]=B(this).attr("data-full");y["data_end"]["data-year"]=parseInt(B(this).attr("data-year"));y["data_end"]["data-month"]=parseInt(B(this).attr("data-month"));y["data_end"]["data-day"]=parseInt(B(this).attr("data-day"))}else{if(parseInt(I)<parseInt(D)){y["data_end"]["data-full"]=y["data_begin"]["data-full"];y["data_end"]["data-year"]=y["data_begin"]["data-year"];y["data_end"]["data-month"]=y["data_begin"]["data-month"];y["data_end"]["data-day"]=y["data_begin"]["data-day"];y["data_begin"]["data-full"]=B(this).attr("data-full");y["data_begin"]["data-year"]=parseInt(B(this).attr("data-year"));y["data_begin"]["data-month"]=parseInt(B(this).attr("data-month"));y["data_begin"]["data-day"]=parseInt(B(this).attr("data-day"))}}}else{if(parseInt(G)<parseInt(F)){y["data_end"]["data-full"]=y["data_begin"]["data-full"];y["data_end"]["data-year"]=y["data_begin"]["data-year"];y["data_end"]["data-month"]=y["data_begin"]["data-month"];y["data_end"]["data-day"]=y["data_begin"]["data-day"];y["data_begin"]["data-full"]=B(this).attr("data-full");y["data_begin"]["data-year"]=parseInt(B(this).attr("data-year"));y["data_begin"]["data-month"]=parseInt(B(this).attr("data-month"));y["data_begin"]["data-day"]=parseInt(B(this).attr("data-day"))}else{if(parseInt(G)>parseInt(F)){y["data_end"]["data-full"]=B(this).attr("data-full");y["data_end"]["data-year"]=parseInt(B(this).attr("data-year"));y["data_end"]["data-month"]=parseInt(B(this).attr("data-month"));y["data_end"]["data-day"]=parseInt(B(this).attr("data-day"))}}}}}else{this.repeat=true}}}}}q();j();Ab();if(this.repeat){y["data_end"]["data-full"]=null}else{if(!this.repeat&&this.differ){}}}})};function Al(){Ag();q()}Al();j();Ab()}};B.fn.xjfCalendar=function(A){if(typeof A==="string"){var D=Array.prototype.slice.call(arguments,1);this.each(function(){var C=B.data(this,"calendar");C[A].apply(C,D)});return true}else{return this.each(function(){var C=B.data(this,"calendar");if(!C){B.data(this,"calendar",new B.Calendar(A,this))}})}}})(jQuery);$.fn.ShowCalendar=function(H){var G=$(this);H=$.extend({"reg_year":1970,"reg_month":1,"reg_date":1,"callback":null,"column_style":null,"date_range_begin":{"year":0,"month":0,"day":0},"date_range_end":{"year":0,"month":0,"day":0},"ifrange_same":null,"begin_today":false},H);var F=[];$(this).each(function(){var A=$(this).next(".fc_area_sub").find(".calendar-box");A.xjfCalendar({"reg_year":H.reg_year,"reg_month":H.reg_month,"reg_date":H.reg_date,"target":G,callback:H.callback,"column_style":H.column_style,"date_range_begin":H.date_range_begin,"date_range_end":H.date_range_end,"ifrange_same":H.ifrange_same,"begin_today":H.begin_today});F[0]=A});var E=$(this);$(this).siblings(".select").click(function(){var A=E.next(".calendar-box");A.show()});return F};